version: '2'

services:
  proxy:
    build: proxy
    ports:
      - "127.0.0.1:13194:13194"
    command: TCP-LISTEN:13194,fork TCP:172.17.0.1:1194
    restart: always
  openvpn:
    build: openvpn
    volumes:
      - ./config:/etc/openvpn
    network_mode: host
    cap_add:
      - NET_ADMIN
    environment:
      dest: docker.ovpn
      DEBUG: '1'
    command: /local/helpers/run.sh
    restart: always
  latest:
    build: .
    privileged: true
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    volumes_from:
      - container:data
